<!doctype html>
<html>
  <head>
  <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <!-- SERVER -->
    <script src="/rhizome/rhizome.js"></script>
    <script src="speakClient.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/jquery-ui.js"></script>
    <script src="js/mcluhan.js"></script>
    <link rel="stylesheet" type="text/css" href="css/controls-dark.css">
    <script src="js/nexusUI.js"></script>
    <script src="js/rack-abs.js"></script>
    <script src="js/jest.js"></script>

    <!-- this is also in space.html ... needs to be encapsulated eventually  -->
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>

<!--
    <script>
        function startgapi() {
          console.log(gapi)
          gapi.client.setApiKey("AIzaSyCtqhb-u4gJyt8f-vuf7tDadc68MvaUDn4")
          gapi.client.load("customsearch", 1);
        }
       
 
    </script>

    <script src="https://apis.google.com/js/client.js?onload=startgapi"></script>-->


    <script>


    /* Audio stuff */


      var sampler = new Tone.Sampler({
          "pno" : "./media/pno.mp3",
          "pnoc3" : "./media/pnoc3.mp3"
        },{
          player: {
            loop: true,
          }
      }) 


     /* SERVER */
     $(function() {

      rhizome.start(function(err) {
        // If we want to receive all messages, we subscribe to '/'
        // rhizome.send('/sys/subscribe', ['/'])
        // In this example, we don't want to subscribe to anything...
      })

      /*rhizome.on('message', function(address, args) { 
        console.log(address, args)
      }) */

      rhizome.on('connected', function() {
        console.log('connected')
      })

      rhizome.on('connection lost', function() {
        console.log('connection lost!')
      })

      rhizome.on('queued', function() {
        console.log('queued!')
      })

    })



     /* NETWORK OBJECT */

    var Network = {
      makeWall: function(name,type) {
        console.log("makeWall")
        console.log(name, type)
        rhizome.send('/wall', ['make',name,type])
        var newshelf = new shelf(type,name)
       // newshelf.ID = name
        shelves[name] = newshelf
        addRack("wall",newshelf)
      },
      makeMedia: function(type,wallname,method,params) {
        console.log("makeMedia")
        console.log(type,wallname,method,params)
        rhizome.send('/media', ['make',type,wallname,method,params])
       // a.video = a.watch(src)
        addRack(type,shelves[wallname])
      },
      makeReceiver: function(widgetID,func,shelfname,mediatype) {
        console.log("makeRcv")
        console.log(widgetID,func,shelfname,mediatype)
        rhizome.send('/receiver', [widgetID,func,shelfname,mediatype]);
      } 

    }

    </script>
  </head>
  <body>

  	<header>mcluhan.js: &nbsp; real.time net.art</header>

    <button onclick="startwalls()">start walls</button>
    <button onclick="createMedia()">first media</button>

    <div style="width:100%;overflow:auto:border:solid 1px white;margin:10px">
    <div style="width:10000px;">

      <div id="shelves" style="float:left;">
      </div>

  <!--    <div style="width:100px;background-color:none;float:left;">
        <button onclick="makewall(this.innerHTML)">default</button>
        <button onclick="makewall(this.innerHTML)">line</button>
        <button onclick="makewall(this.innerHTML)">big1</button>
        <button onclick="makewall(this.innerHTML)">grid4</button>
        <button onclick="makewall(this.innerHTML)">fauve</button>
  -->

        <div style="position:fixed;right:0px;top:0px;width:100px;height:100%;padding:30px 10px;background-color:black;color:#eee;font-size:8pt">
          <canvas nx="toggle" id="presencecontrol" style="width:30px;height:30px;float:left"></canvas> 
          <div style="line-height:30px;float:left"> presence</div>

          
          <canvas nx="text" id="voicecontrol" style="width:100px;height:60px;clear:both;"></canvas>
          <div style="padding:0px 0px 10px">voice</div>

          <!-- gesture playlist -->
          <canvas nx="ghostlist" style="margin:0px;padding:0px;border-radius:0px;position:relative;right:0px"></canvas>
          <div id="playlist1" style="margin-top:-4px"></div>
          
        </div>
      </div>
    </div>
    </div>



  	<script>

      //m.deck(8)

      nx.onload = function() {

        nx.colorize("fill","#444")
        nx.colorize("accent","#1bd")
        nx.colorize("border","#666")
        nx.colorize("black","#ccc")

        jest = new Jest("playlist1",ghostlist1,49)
       // jest2 = new Jest("playlist2",ghostlist2,50)

        voicecontrol.on('*',function(data) {
          if (data.text) {
            siri.say(data.text)
          }
        })
        

      }

      $(function() {

        // how to load this????
       // loadScript("https://maps.googleapis.com/maps/api/js?v=3.exp");
        
      })

      //MOVE TO OWN FILE

      function startwalls() {

        Network.makeWall("a","line")
        Network.makeWall("b","fauve")

      }

      function createMedia() {

        Network.makeMedia("film","a","watch","lake")
        Network.makeMedia("film","b","watch","lake")
        Network.makeMedia("cassette","a","hear","pno")
        Network.makeMedia("cassette","b","hear","pno")

      }


    </script>

  </body>
</html>